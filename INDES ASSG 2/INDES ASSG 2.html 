<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Rizz Taker: AI Romance Scams</title>
    <style>
        /* --- 1. CUSTOM FONT LOADING --- */
        /* NOTE: Ensure 'fonts/RimouskiSemiBold.ttf' path is correct */
        @font-face {
            font-family: 'RimouskiSemiBold';
            src: url('fonts/RimouskiSemiBold.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }

        /* --- Base Setup (Preserving consistency) --- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            cursor: none; /* Keep cursor hidden for custom trail */
        }

        body {
            background: #100114; /* Keep original background color */
            height: 100vh;
            width: 100vw;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            font-family: 'RimouskiSemiBold', monospace; /* Keep consistent font */
        }

        /* --- Container --- */
        #container {
            width: 960px;
            height: 540px;
            background-image: url('Galaxy BG.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            
            /* Initial Glow (Pink) */
            box-shadow: 0 0 30px #fb5ea6,
                        0 0 50px rgba(251, 94, 166, 0.4);
                
            transform-origin: center center;
            transform: scale(1);
            
            position: relative;
            z-index: 10;
            overflow: hidden;
            transition: background-image 1s ease-in-out, box-shadow 1s ease-in-out;
        }

        /* --- Glow Consistency --- */
        #container.red-glow {
            box-shadow: 0 0 30px #FF0000,
                        0 0 50px rgba(255, 0, 0, 0.6);
        }
      
        #container.congrats-glow { /* Used for pink background/final screen */
            box-shadow: 0 0 30px #fb5ea6,
                        0 0 50px rgba(251, 94, 166, 0.4);
        }
       
        #container.blue-glow { /* Used for Level 2 */
            box-shadow: 0 0 30px #00FFFF,
                        0 0 50px rgba(0, 255, 255, 0.6);
        }
      

        @media screen and (max-width: 960px), screen and (max-height: 540px) {
            #container {
                transform: scale(min(calc(100vw / 960), calc(100vh / 540)));
            }
        }

        /* --- Fading Transition --- */
        .fade-element {
            transition: opacity 0.5s ease-out, visibility 0.5s;
        }
      
        /* --- Raining Hearts Effect (Background) --- */
        .heart-rain-container { /* Preserve heart fall background */
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            pointer-events: none;
            overflow: hidden;
            z-index: 1;
        }
      
        .heart {
            position: absolute;
            user-select: none;
            opacity: 0;
            animation: rain-of-hearts 8s linear infinite;
        }

        .heart img {
            width: 40px;
            height: auto;
            image-rendering: pixelated;
            display: block;
        }

        @keyframes rain-of-hearts {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.8;
            }
            90% {
                opacity: 0.8;
            }
            100% {
                transform: translateY(110vh) rotate(360deg);
                opacity: 0;
            }
        }
      
        /* --- Pink Light Stream Overlay --- */
        #stream-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            pointer-events: none;
            overflow: hidden;
            z-index: 5;
            width: 1px;
            height: 1px;
            animation: stream-down 10s linear infinite;
        }

        #stream-overlay::before {
            content: '';
            position: absolute;
            width: 1px;
            height: 100vh;
            background: transparent;
          
            box-shadow:
                20px -200vh 20px 1px rgba(251, 94, 166, 0.5),
                70px -150vh 15px 0px rgba(251, 94, 166, 0.4),
                150px -100vh 25px 2px rgba(251, 94, 166, 0.6),
                250px -50vh 10px 0px rgba(251, 94, 166, 0.3),
                380px -200vh 22px 1px rgba(251, 94, 166, 0.55),
                420px -100vh 18px 0px rgba(251, 94, 166, 0.45),
                590px -150vh 20px 1px rgba(251, 94, 166, 0.5),
                700px -200vh 15px 0px rgba(251, 94, 166, 0.4),
                850px -50vh 25px 2px rgba(251, 94, 166, 0.6),
                950px -180vh 10px 0px rgba(251, 94, 166, 0.3);
          
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
        }

        @keyframes stream-down {
            0% { transform: translateY(0); }
            100% { transform: translateY(100vh); }
        }

        /* --- TITLE SCREEN ELEMENTS (Preserve) --- */
        #title-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10;
        }
      
        .positioned-asset {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            image-rendering: pixelated;
            /* Placeholder styles for RIZZ TAKER/PLAY OR BE PLAYED images (as in original) */
        }

        @keyframes blink {
            0%, 49% { opacity: 1; }
            50%, 100% { opacity: 0; }
        }
        #rizz-taker-header { 
            top: 28%; width: 500px; animation: blink 2s steps(1, end) infinite; 
            content: url("THE RIZZ TAKER_.png");
        }
        #info-textbox { 
            top: 40%; width: 400px; 
            content: url("PLAY OR BE PLAYED_.png");
        }
        /* START BUTTON */
        #start-button-link {
            position: absolute;
            left: 50%;
            top: 80%;
            transform: translateX(-50%) scale(1);
            display: block;
            filter: drop-shadow(0 0 0 transparent);
            transition: filter 0.1s ease-out;
            cursor: pointer;
            z-index: 11;
        }
        #start-button-link img { 
            width: 180px; display: block; image-rendering: pixelated; 
            content: url("Start Button.png"); 
        }
        #start-button-link:hover {
            filter: drop-shadow(0 0 10px #FFD700) drop-shadow(0 0 20px rgba(255, 215, 0, 0.5));
        }
        #start-button-link:active {
            filter: drop-shadow(0 0 15px #FFFF00) drop-shadow(0 0 30px #FFC700);
            transform: translateX(-50%) scale(0.95);
        }


        /* --- LEVEL 1: MAZE SCREEN ELEMENTS (Preserve) --- */
        #maze-screen {
            /* Maze styles preserved */
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            visibility: hidden;
            opacity: 0;
            z-index: 10;
        }
        /* ... existing maze button styles (rf-button-1, etc.) preserved ... */


        /* --- LEVEL 2: QUIZ SCREEN ELEMENTS (Preserve) --- */
        #quiz-screen {
            /* Quiz styles preserved */
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            visibility: hidden;
            opacity: 0;
            z-index: 10;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 20px;
            background-color: rgba(16, 1, 20, 0.9); /* Dark overlay */
        }
        /* ... existing quiz element styles preserved ... */


        /* --- LEVEL 3: CHAT SCREEN ELEMENTS (NEW/Modified) --- */
        #chat-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            visibility: hidden;
            opacity: 0;
            z-index: 10;
            display: flex;
            flex-direction: column;
            justify-content: flex-end; /* Push input to bottom */
            background-size: cover; /* Ensure image fits fully in container */
            background-position: center;
            transition: opacity 0.5s ease-out, visibility 0.5s, background-image 0.5s linear;
        }

        #input-container {
            width: 100%;
            display: flex;
            gap: 10px;
            padding: 20px;
            background-color: rgba(16, 1, 20, 0.9); /* Semi-transparent base for buttons */
        }

        /* --- Button Styling (Ensuring Consistency: Blue, Rounded, Rimouski) --- */
        .setup-button {
            font-family: 'RimouskiSemiBold', monospace;
            padding: 10px 20px;
            border: 2px solid #FF00FF; /* Pink border */
            border-radius: 10px; /* Rounded */
            background-color: #100114; /* Dark BG */
            color: #FF00FF; /* Pink text */
            font-size: 16px;
            cursor: none;
            box-shadow: 0 0 10px #FF00FF;
            transition: all 0.15s ease-out;
        }
        .setup-button:hover {
            box-shadow: 0 0 15px #FF00FF, 0 0 25px rgba(255, 0, 255, 0.5);
            transform: scale(1.05);
        }

        /* Special style for chat choice buttons (Blue & Rounded) */
        .chat-choice-button {
            flex-grow: 1;
            background-color: #00FFFF; /* BLUE background */
            color: #100114; /* Dark text for contrast */
            border-color: #FF00FF; /* Pink border */
            box-shadow: 0 0 8px rgba(0, 255, 255, 0.5);
            font-size: 14px;
            padding: 15px 10px; /* Make them larger/more prominent */
            min-width: 0; 
            white-space: normal; /* Allow text to wrap */
            height: auto;
        }
        .chat-choice-button:hover {
            background-color: #008888;
            box-shadow: 0 0 15px #FF00FF;
        }

        /* --- POPUP/NOTIFICATION STYLES (Preserve) --- */
        #popup-overlay {
            /* Popup styles preserved */
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }
        #popup-box {
            /* Popup box styles preserved */
            width: 80%;
            max-width: 500px;
            background-color: #100114;
            border: 4px solid #FF00FF;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            color: #FFFFFF;
            box-shadow: 0 0 25px #FF00FF;
            font-size: 18px;
            line-height: 1.4;
        }
        #popup-title {
            color: #00FFFF; /* Cyan for title */
            font-size: 24px;
            margin-bottom: 10px;
        }
        #popup-text {
            margin-bottom: 20px;
            white-space: pre-wrap;
        }
        #popup-close-button {
            /* Use chat button style for consistency */
            background-color: #00FFFF;
            color: #100114;
            border-color: #FF00FF;
            box-shadow: 0 0 8px rgba(0, 255, 255, 0.5);
            font-size: 16px;
            cursor: pointer;
        }
        #popup-close-button.game-over-button {
            /* Red style for game over */
            background-color: #FF0000;
            border-color: #FFFFFF;
            box-shadow: 0 0 15px #FF0000;
            color: #FFFFFF;
        }
        /* --- AVATAR CORNER (Preserve) --- */
        #avatar-corner {
            /* Avatar corner styles preserved */
            position: absolute;
            top: 10px;
            right: 10px;
            width: 80px;
            height: 80px;
            border: 2px solid #fb5ea6;
            border-radius: 5px;
            background-image: url('AlexAvatar.png'); /* NOTE: Using existing asset path */
            background-size: cover;
            background-position: center;
            box-shadow: 0 0 10px rgba(251, 94, 166, 0.7);
            z-index: 20;
            transition: border-color 0.5s, box-shadow 0.5s;
        }

    </style>
</head>
<body>

    <div class="heart-rain-container"></div>
    <div id="stream-overlay"></div>
    <div id="custom-cursor" style="position: fixed; width: 10px; height: 10px; background-color: #FF00FF; border-radius: 50%; pointer-events: none; z-index: 9999; transform: translate(-50%, -50%); transition: width 0.1s, height 0.1s, opacity 0.3s; opacity: 0;"></div>

    <div id="container">
        <div id="avatar-corner"></div>

        <div id="title-screen" class="fade-element">
            <div id="rizz-taker-header" class="positioned-asset"></div>
            <div id="info-textbox" class="positioned-asset"></div>
            <a id="start-button-link" href="#" onclick="transitionToSetup(event)">
                <img src="Start Button.png" alt="Start Game">
            </a>
        </div>

        <div id="profile-setup-screen" class="fade-element" style="display: none; visibility: hidden; opacity: 0;">
            </div>

        <div id="maze-screen" class="fade-element">
            </div>

        <div id="quiz-screen" class="fade-element">
            </div>

        <div id="chat-screen" class="fade-element">
            <div id="input-container">
                <button id="chat-choice-1" class="setup-button chat-choice-button" onclick="handleLevel3Choice(0)">Option 1</button>
                <button id="chat-choice-2" class="setup-button chat-choice-button" onclick="handleLevel3Choice(1)">Option 2</button>
            </div>
        </div>
        
        <div id="congrats-screen" class="fade-element" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; visibility: hidden; opacity: 0; background-color: rgba(16, 1, 20, 0.9);">
            <h1 id="final-score-text" style="color: #FF00FF; margin-top: 20px;">Score: 0 / 4 Correct</h1>
            <button id="play-again-button" class="setup-button" style="margin-top: 30px; font-size: 20px;" onclick="window.location.reload()">Play Again?</button>
        </div>

        <div id="popup-overlay" onclick="hidePopup(event)">
            <div id="popup-box" onclick="event.stopPropagation()">
                <h2 id="popup-title">Notification</h2>
                <p id="popup-text">Details here.</p>
                <button id="popup-close-button" class="setup-button" onclick="hidePopup()">Close</button>
            </div>
        </div>

    </div>


    <script>
        // --- DOM Elements (Preserve) ---
        const container = document.getElementById('container');
        const titleScreen = document.getElementById('title-screen');
        const setupScreen = document.getElementById('profile-setup-screen');
        const mazeScreen = document.getElementById('maze-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const chatScreen = document.getElementById('chat-screen');
        const congratsScreen = document.getElementById('congrats-screen');
        const avatarCorner = document.getElementById('avatar-corner');
        const customCursor = document.getElementById('custom-cursor');
        const popupOverlay = document.getElementById('popup-overlay');
        const popupTitle = document.getElementById('popup-title');
        const popupText = document.getElementById('popup-text');
        const popupCloseButton = document.getElementById('popup-close-button');
        const finalScoreText = document.getElementById('final-score-text');

        // Level 3 Chat Elements
        const chatChoice1 = document.getElementById('chat-choice-1');
        const chatChoice2 = document.getElementById('chat-choice-2');

        // --- Game State (Preserve/Update) ---
        let score = 0; // Total Correct Answers across all levels
        let level3CurrentStep = 0;
        let level2State = 0; // Current question index for Level 2 quiz
        let level1RedFlagsFound = 0; // Counter for Level 1 maze

        // --- Data: LEVEL 3 CHAT DATA (NEW LOGIC) ---
        const level3ChatData = [
            // Step 0: Chat 1 - Love Bombing
            {
                image: 'Chat 1_.png',
                choices: [
                    { text: "Woah, not so fast! Let’s slow down.", correct: true }, // Mark Correct
                    { text: "OMG! I feel it too Alex!", correct: false }          // Mark Incorrect
                ],
                redFlag: "Red Flag 1: Love Bombing\nExpressing deep love, devotion, and talk of a future together within days or weeks of starting the conversation."
            },
            // Step 1: Chat 2 - Overseas/Unavailable
            {
                image: 'Chat 2.png',
                choices: [
                    { text: "Hmmm, maybe we should meet up in person?", correct: true }, // Mark Correct
                    { text: "Wow, that's exciting work! Be safe.", correct: false }    // Mark Incorrect
                ],
                redFlag: "Red Flag 2: Overseas/Unavailable\nThey claim to be local, but are always traveling, overseas, or working in a remote/secret location (eg, oil rig or military service) that prevents them from meeting or calling."
            },
            // Step 2: Chat 3 - Avoids Live Calls
            {
                image: 'Chat 3_.png',
                choices: [
                    { text: "I only trust live verification. This is suspicious.", correct: true }, // Mark Correct
                    { text: "Aww, thanks for the video! It's so sweet.", correct: false }       // Mark Incorrect
                ],
                redFlag: "Red Flag 3: Avoids Live Calls\nThey consistently refuse requests for a live phone call or video chat, only sending pre-recorded videos that may be deepfakes or stolen. They use excuses like “poor signal,” “broken camera,” or “security protocols.”"
            },
            // Step 3: Chat 4 - The Financial Hook (Final Step)
            {
                image: 'Chat 4.png',
                choices: [
                    { text: "I don’t send money to strangers. END CHAT.", correct: true, end_game: 'pass' }, // Pass Level
                    { text: "Oh no! Which kind of gift card should I get?", correct: false, end_game: 'fail' } // Game Over!
                ],
                redFlag: "Red Flag 4: The Financial Hook\nThey quickly move to a sudden, urgent request for money. They demand payment via untraceable methods like cryptocurrency or gift cards."
            }
        ];
        
        const MAX_LEVEL3_SCORE = level3ChatData.length;


        // --- Core Functions (Preserve) ---

        // Function to show a custom popup
        function showPopup(title, text, isRedFlag = false, closeButtonText = 'Close', isGameOver = false) {
            popupTitle.textContent = title;
            popupText.textContent = text;
            popupCloseButton.textContent = closeButtonText;
            
            // Apply Red Flag specific styling/text
            if (isRedFlag) {
                popupTitle.style.color = '#FF0000'; // Red for Red Flag
                popupBox.style.borderColor = '#FF0000';
                popupBox.style.boxShadow = '0 0 25px #FF0000';
            } else {
                // Default Blue/Pink
                popupTitle.style.color = '#00FFFF'; 
                popupBox.style.borderColor = '#FF00FF';
                popupBox.style.boxShadow = '0 0 25px #FF00FF';
            }

            // Apply Game Over specific styling
            if (isGameOver) {
                popupCloseButton.classList.add('game-over-button');
            } else {
                popupCloseButton.classList.remove('game-over-button');
            }

            popupOverlay.style.display = 'flex';
        }

        // Function to hide the custom popup
        function hidePopup(event) {
            if (event && event.target !== popupOverlay && event.target !== popupCloseButton) return;
            popupOverlay.style.display = 'none';
        }
        
        // Function to reset all screens (Helper for transitions)
        function resetAllScreens() {
            [titleScreen, setupScreen, mazeScreen, quizScreen, chatScreen, congratsScreen].forEach(screen => {
                screen.style.opacity = '0';
                screen.style.visibility = 'hidden';
            });
        }
        
        // --- LEVEL 0/0.5/1/2 TRANSITIONS (Preserve) ---

        function transitionToSetup(event) {
            event.preventDefault();
            // ... existing Level 0 to 0.5 transition logic ...
        }

        function transitionToNextScreen() {
            // ... existing Level 0.5 to 1 transition logic ...
        }

        function completeMaze() {
            // ... existing Level 1 completion logic ...
            // Calls transitionToQuizScreen()
        }

        function transitionToQuizScreen() {
            // ... existing Level 1 to 2 transition logic ...
        }
        
        // Mock function for Level 2 completion (Assume this is triggered by a button click after answering the last quiz question)
        function checkLevel2Answers() {
            // NOTE: Assuming this is the existing entry point for Level 2 completion
            // In a real implementation, quiz answers would be checked here.
            // For now, we assume successful completion of Level 2.
            
            // Mock Level 2 Score (e.g., if max score is 5, and they got 4)
            // This is just to ensure Level 3 score starts correctly.
            score = 4; // Example score from previous levels

            // Transition to Level 3 Chat
            transitionToLevel3();
        }

        // --- LEVEL 3: CHAT LOGIC (NEW IMPLEMENTATION) ---
        
        function transitionToLevel3() {
            // 1. Hide the previous screen (Quiz or Maze Congrats)
            quizScreen.style.opacity = '0';
            quizScreen.style.visibility = 'hidden';

            setTimeout(() => {
                // 2. Change the main container background to 'pink background.png'
                container.style.backgroundImage = "url('pink background.png')";
                container.style.backgroundSize = "cover"; // Ensure it fits fully
                
                // 3. Apply Pink Glow effect (congrats-glow)
                container.classList.add('congrats-glow');
                container.classList.remove('red-glow', 'blue-glow');
                
                // 4. Show the Chat Screen
                chatScreen.style.opacity = '1';
                chatScreen.style.visibility = 'visible';

                // 5. Start the chat sequence
                level3CurrentStep = 0;
                displayChatStep(level3CurrentStep);

            }, 550); // Wait for fade out
        }

        function displayChatStep(step) {
            if (step >= level3ChatData.length) {
                // All steps complete, transition to final congrats/score screen
                transitionToFinalCongrats();
                return;
            }

            const chatStep = level3ChatData[step];

            // 1. Set the background image for the current chat step
            chatScreen.style.backgroundImage = `url('${chatStep.image}')`;

            // 2. Update the choice buttons
            chatChoice1.textContent = chatStep.choices[0].text;
            chatChoice2.textContent = chatStep.choices[1].text;
        }

        function handleLevel3Choice(choiceIndex) {
            const chatStep = level3ChatData[level3CurrentStep];
            const chosenOption = chatStep.choices[choiceIndex];

            // 1. Check if the choice is correct
            if (chosenOption.correct) {
                // Correct Choice (Mark Correct)
                score++;
                
                // Check for Level Pass/End Game condition
                if (chosenOption.end_game === 'pass') {
                    // Final correct choice
                    level3CurrentStep++; // Move past the last step
                    displayChatStep(level3CurrentStep); // Calls transitionToFinalCongrats()
                    return;
                }
                
                // Show brief confirmation pop-up
                showPopup('Correct!', 'You successfully identified the hidden red flag trap.', false, 'Continue');

            } else {
                // Incorrect Choice (Mark Incorrect)
                
                // Check for Game Over condition
                if (chosenOption.end_game === 'fail') {
                    // Final incorrect choice - Game Over!
                    showPopup('GAME OVER!', chatStep.redFlag + '\n\n> Game Over!', true, 'End Game', true);
                    popupCloseButton.onclick = transitionToGameOver;
                    return;
                }
                
                // Show Red Flag notification
                showPopup('RED FLAG ALERT!', chatStep.redFlag, true, 'Continue');
            }

            // 2. Advance to the next step
            level3CurrentStep++;
            popupCloseButton.onclick = () => { 
                hidePopup(); 
                displayChatStep(level3CurrentStep); 
            };
        }


        // --- END GAME TRANSITIONS (Modified for final score) ---

        function transitionToFinalCongrats() {
            // Hide Chat Screen
            chatScreen.style.opacity = '0';
            chatScreen.style.visibility = 'hidden';

            setTimeout(() => {
                // Show Congrats Screen
                congratsScreen.style.opacity = '1';
                congratsScreen.style.visibility = 'visible';
                
                // Update Final Score
                finalScoreText.textContent = `FINAL SCORE: ${score} / ${MAX_LEVEL3_SCORE + 5} Correct`; // Assuming 5 points from previous levels

                // Apply Pink Glow (already set by transitionToLevel3)
                container.classList.add('congrats-glow');
                container.classList.remove('red-glow', 'blue-glow');

            }, 550);
        }

        function transitionToGameOver() {
            hidePopup();
            // Implement logic for Game Over screen if different from Final Congrats
            // For now, reuse congrats screen but with Game Over message if needed.
            // Since the user asked for Score Count at the end, we'll direct to the score screen.
            transitionToFinalCongrats(); 
        }

        // --- GLOBAL SETUP (Preserve) ---

        // Heart Rain Effect
        const heartRainContainer = document.querySelector('.heart-rain-container');
        const heartImages = ['Heart_Pink.png', 'Heart_Cyan.png', 'Heart_Magenta.png']; // Assuming these assets exist

        function createHeart() {
            const heart = document.createElement('div');
            heart.classList.add('heart');
            
            const img = document.createElement('img');
            img.src = heartImages[Math.floor(Math.random() * heartImages.length)];
            
            heart.appendChild(img);
            heart.style.left = Math.random() * 100 + 'vw';
            heart.style.animationDelay = Math.random() * -8 + 's';
            heart.style.opacity = 0; // Starts hidden, fades in via keyframes
            heart.style.transform = `scale(${Math.random() * 0.5 + 0.5})`; // Random size

            heartRainContainer.appendChild(heart);
            
            // Clean up heart after animation
            heart.addEventListener('animationend', () => {
                heart.remove();
            });
        }
        
        // Initial heart generation
        for (let i = 0; i < 30; i++) {
            createHeart();
        }

        // Generate a new heart every 0.5 seconds (Maintain consistency)
        setInterval(createHeart, 500);


        // Custom Cursor Trail (Preserve)
        document.addEventListener('mousemove', (e) => {
            customCursor.style.opacity = '1';
            customCursor.style.left = e.clientX + 'px';
            customCursor.style.top = e.clientY + 'px';

            // Create a trail heart particle
            const trailHeart = document.createElement('img');
            trailHeart.src = 'Heart_Pink.png';
            trailHeart.style.position = 'fixed';
            trailHeart.style.width = '20px';
            trailHeart.style.height = 'auto';
            trailHeart.style.left = e.clientX + 'px';
            trailHeart.style.top = e.clientY + 'px';
            trailHeart.style.pointerEvents = 'none';
            trailHeart.style.opacity = '0.8';
            trailHeart.style.transform = 'translate(-50%, -50%)';
            trailHeart.style.transition = 'all 0.5s ease-out';
            trailHeart.style.zIndex = '9998';

            document.body.appendChild(trailHeart);

            // Animate fade and shrink
            setTimeout(() => {
                trailHeart.style.opacity = '0';
                trailHeart.style.transform = 'translate(-50%, -50%) scale(0.2)';
            }, 50);

            // Remove the element after transition
            setTimeout(() => {
                trailHeart.remove();
            }, 600);
        });

        document.addEventListener('mouseleave', () => {
            customCursor.style.opacity = '0';
        });

        // Set up initial element visibility (The original logic for all levels)
        // NOTE: You must ensure your game flow calls these functions correctly.
        document.addEventListener('DOMContentLoaded', () => {
            // Ensure only the title screen is visible initially
            titleScreen.style.opacity = '1';
            titleScreen.style.visibility = 'visible';
            
            // Setup screens are hidden
            setupScreen.style.display = 'flex'; // Keep flex for setup
            setupScreen.style.visibility = 'hidden';
            mazeScreen.style.visibility = 'hidden';
            quizScreen.style.visibility = 'hidden';
            chatScreen.style.visibility = 'hidden'; // NEW: Chat screen hidden
            congratsScreen.style.visibility = 'hidden';
        });

        // Placeholder for Level 2 completion button (Ensure this element exists in your Level 2 HTML structure)
        // document.getElementById('submit-quiz-button').onclick = checkLevel2Answers; 
    </script>
</body>
</html>